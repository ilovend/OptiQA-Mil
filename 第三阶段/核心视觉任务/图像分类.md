# 图像分类学习笔记 — 框架

说明：本文件为学习图像分类技术的笔记框架，后续在对应小节补充要点、示例、习题与心得。

## 目录
- [图像分类概述](#图像分类概述)
- [传统图像分类方法](#传统图像分类方法)
- [基于CNN的图像分类](#基于cnn的图像分类)
- [图像分类数据集](#图像分类数据集)
- [训练与优化策略](#训练与优化策略)
- [模型评估与指标](#模型评估与指标)
- [小样本与少样本学习](#小样本与少样本学习)
- [多标签分类](#多标签分类)
- [不平衡数据处理](#不平衡数据处理)
- [部署与优化](#部署与优化)
- [工业检测应用](#工业检测应用)
- [学习资源与书签](#学习资源与书签)
- [学习进度与 TODO 列表](#学习进度与-todo-列表)

---

## 图像分类概述
- 图像分类任务定义
- 分类与其他视觉任务的区别
- 分类系统的一般流程
- 挑战与研究前沿
- 工业应用场景
- 示例：
```python
# 图像分类流程示例
import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import accuracy_score, classification_report, confusion_matrix
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D, MaxPooling2D, Dense, Flatten, Dropout
from tensorflow.keras.utils import to_categorical
import seaborn as sns

# 模拟生成一个小型图像分类数据集
def generate_synthetic_data(n_samples=1000, img_size=32, n_classes=5):
    # 生成随机图像
    X = np.random.rand(n_samples, img_size, img_size, 3) * 255
    
    # 生成分类标签
    y = np.random.randint(0, n_classes, n_samples)
    
    # 在每个类别的图像上添加一些特征
    for i in range(n_samples):
        class_idx = y[i]
        # 在不同位置添加与类别相关的特征
        start_row = int((class_idx / n_classes) * img_size)
        start_col = int((class_idx / n_classes) * img_size / 2)
        
        # 添加类别相关的模式
        X[i, start_row:start_row+8, start_col:start_col+8, :] = class_idx * 50
    
    return X, y

# 生成数据
X, y = generate_synthetic_data(n_samples=500)
class_names = [f"Class {i}" for i in range(5)]

# 数据集划分
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 数据预处理
X_train = X_train / 255.0
X_test = X_test / 255.0
y_train_cat = to_categorical(y_train)
y_test_cat = to_categorical(y_test)

# 显示一些样本图像
plt.figure(figsize=(12, 6))
for i in range(10):
    plt.subplot(2, 5, i+1)
    plt.imshow(X_train[i].astype('uint8'))
    plt.title(f"Label: {class_names[y_train[i]]}")
    plt.axis('off')
plt.tight_layout()
plt.show()

# 构建简单的CNN模型
model = Sequential([
    Conv2D(32, (3, 3), activation='relu', input_shape=(32, 32, 3)),
    MaxPooling2D((2, 2)),
    Conv2D(64, (3, 3), activation='relu'),
    MaxPooling2D((2, 2)),
    Conv2D(64, (3, 3), activation='relu'),
    Flatten(),
    Dense(64, activation='relu'),
    Dropout(0.5),
    Dense(5, activation='softmax')
])

# 编译模型
model.compile(optimizer='adam',
              loss='categorical_crossentropy',
              metrics=['accuracy'])

# 训练模型（实际应用中需要更多的轮次）
history = model.fit(
    X_train, y_train_cat,
    epochs=5,
    batch_size=32,
    validation_data=(X_test, y_test_cat)
)

# 评估模型
y_pred = model.predict(X_test)
y_pred_classes = np.argmax(y_pred, axis=1)

# 打印评估报告
print("\n分类报告:")
print(classification_report(y_test, y_pred_classes, target_names=class_names))

# 绘制混淆矩阵
plt.figure(figsize=(10, 8))
cm = confusion_matrix(y_test, y_pred_classes)
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', xticklabels=class_names, yticklabels=class_names)
plt.xlabel('预测标签')
plt.ylabel('真实标签')
plt.title('混淆矩阵')
plt.show()

# 绘制训练历史
plt.figure(figsize=(12, 4))
plt.subplot(1, 2, 1)
plt.plot(history.history['accuracy'], label='训练准确率')
plt.plot(history.history['val_accuracy'], label='验证准确率')
plt.xlabel('Epoch')
plt.ylabel('准确率')
plt.legend()

plt.subplot(1, 2, 2)
plt.plot(history.history['loss'], label='训练损失')
plt.plot(history.history['val_loss'], label='验证损失')
plt.xlabel('Epoch')
plt.ylabel('损失')
plt.legend()

plt.tight_layout()
plt.show()
```
- 记录：
    - 图像分类基本流程：

## 传统图像分类方法
- 特征提取（HOG、LBP、SIFT）
- 特征降维（PCA、LDA）
- 机器学习分类器（SVM、随机森林）
- Bag of Visual Words
- 传统方法的优缺点
- 记录：
    - 传统方法适用场景：

## 基于CNN的图像分类
- 特征学习与端到端训练
- 分类网络架构演进
- 特征提取网络与分类头
- 注意力机制在分类中的应用
- 最新研究进展（Vision Transformer等）
- 记录：
    - CNN分类模型选择：

## 图像分类数据集
- 常用公开数据集（MNIST、CIFAR、ImageNet）
- 工业图像数据集特点
- 数据集构建与管理
- 标注规范与质量控制
- 数据版本管理
- 记录：
    - 数据集构建经验：

## 训练与优化策略
- 数据增强技术
- 学习率策略
- 批大小选择
- 优化器对比
- 训练监控与早停
- 记录：
    - 训练参数调优经验：

## 模型评估与指标
- 准确率、精确率、召回率
- F1分数与ROC曲线
- 混淆矩阵分析
- Top-K准确率
- 交叉验证
- 记录：
    - 评估方法选择：

## 小样本与少样本学习
- 数据有限情况下的策略
- 数据合成与增强
- 迁移学习与预训练
- 原型网络
- 元学习方法
- 记录：
    - 小样本学习实践：

## 多标签分类
- 多标签问题定义
- 损失函数选择
- 评估指标
- 标签相关性建模
- 多标签分类架构
- 记录：
    - 多标签应用案例：

## 不平衡数据处理
- 类别不平衡问题
- 重采样策略
- 代价敏感学习
- Focal Loss等特殊损失函数
- 单类与异常检测方法
- 记录：
    - 不平衡数据处理技巧：

## 部署与优化
- 模型压缩与量化
- 推理加速技术
- 移动端与嵌入式部署
- 边缘计算平台
- 推理服务架构
- 记录：
    - 部署优化经验：

## 工业检测应用
- 外观缺陷分类
- 产品质量等级分级
- 零部件识别分类
- 分类系统集成
- 实时分类需求
- 记录：
    - 工业应用案例：

## 学习资源与书签
- 图像分类论文列表
- 教程与课程
- 开源实现
- 竞赛与基准
- 记录：
    - 资源链接：

## 学习进度与 TODO 列表
- [ ] 传统分类方法学习
- [ ] CNN分类模型掌握
- [ ] 数据集构建能力
- [ ] 训练与优化技巧
- [ ] 工业应用实践
- 自定义进度记录区：

---

备注：每个章节下可按"要点 / 代码示例 / 习题 / 参考链接 / 个人笔记"五小节结构补充内容。