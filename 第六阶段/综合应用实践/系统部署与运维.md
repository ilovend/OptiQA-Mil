# 系统部署与运维学习笔记 — 框架

说明：本文件为学习系统部署与运维的笔记框架，后续在对应小节补充要点、示例、习题与心得。

## 目录
- [部署规划与准备](#部署规划与准备)
- [环境配置与要求](#环境配置与要求)
- [硬件安装与调试](#硬件安装与调试)
- [软件部署与配置](#软件部署与配置)
- [系统参数优化](#系统参数优化)
- [验收测试流程](#验收测试流程)
- [运行监控系统](#运行监控系统)
- [故障诊断与处理](#故障诊断与处理)
- [预防性维护](#预防性维护)
- [系统升级与扩展](#系统升级与扩展)
- [学习资源与书签](#学习资源与书签)
- [学习进度与 TODO 列表](#学习进度与-todo-列表)

---

## 部署规划与准备
- 部署策略制定
- 风险评估与应对
- 资源需求与规划
- 部署时间安排
- 相关方协调
- 示例：
```python
# 部署规划与进度跟踪可视化示例
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import matplotlib.dates as mdates
from datetime import datetime, timedelta

# 甘特图生成函数
def create_gantt_chart(tasks, start_dates, durations, dependencies=None, resources=None):
    """
    创建部署甘特图
    
    参数:
    tasks (list): 任务名称列表
    start_dates (list): 开始日期列表，datetime对象
    durations (list): 任务持续天数
    dependencies (list, optional): 任务依赖关系列表，如 [(0,1), (1,2)] 表示任务0是任务1的前置任务
    resources (list, optional): 每个任务的资源分配
    """
    # 创建图表
    fig, ax = plt.subplots(figsize=(14, 8))
    
    # Y轴为任务
    y_ticks = range(len(tasks))
    
    # 生成结束日期
    end_dates = [start + timedelta(days=duration) for start, duration in zip(start_dates, durations)]
    
    # 绘制水平条
    for i, task in enumerate(tasks):
        start_date = start_dates[i]
        end_date = end_dates[i]
        
        # 根据任务类型设置不同颜色
        if "准备" in task:
            color = 'lightblue'
        elif "安装" in task or "调试" in task:
            color = 'lightgreen'
        elif "测试" in task:
            color = 'orange'
        else:
            color = 'skyblue'
        
        # 绘制任务条
        ax.barh(i, (end_date - start_date).days, left=mdates.date2num(start_date), 
                height=0.5, color=color, edgecolor='black', alpha=0.8)
        
        # 在任务条上添加任务名称
        ax.text(mdates.date2num(start_date) + (mdates.date2num(end_date) - mdates.date2num(start_date))/2, 
                i, task, va='center', ha='center', color='black')
        
        # 如果有资源信息，添加资源标签
        if resources:
            ax.text(mdates.date2num(end_date) + 0.1, i, resources[i], va='center', ha='left')
    
    # 绘制依赖关系箭头
    if dependencies:
        for from_task, to_task in dependencies:
            # 获取起始任务的结束位置和目标任务的开始位置
            from_end = mdates.date2num(end_dates[from_task])
            to_start = mdates.date2num(start_dates[to_task])
            
            # 如果有依赖关系，绘制箭头
            ax.annotate("", 
                        xy=(to_start, to_task), 
                        xytext=(from_end, from_task),
                        arrowprops=dict(arrowstyle="->", color="gray", lw=1.5, 
                                       connectionstyle="arc3,rad=.1"))
    
    # 设置日期格式
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%Y-%m-%d'))
    ax.xaxis.set_major_locator(mdates.WeekdayLocator(byweekday=mdates.MO))
    
    # 旋转日期标签
    plt.setp(ax.get_xticklabels(), rotation=30, ha='right')
    
    # 设置Y轴刻度
    ax.set_yticks(y_ticks)
    ax.set_yticklabels(tasks)
    
    # 设置网格
    ax.grid(True, axis='x', linestyle='--', alpha=0.7)
    
    # 设置标题和标签
    ax.set_title('光学检测系统部署甘特图', fontsize=14)
    ax.set_xlabel('日期', fontsize=12)
    
    # 调整布局
    plt.tight_layout()
    
    return fig

# 部署风险热图
def create_risk_heatmap():
    # 风险类别和影响区域
    risk_categories = ['技术风险', '进度风险', '人员风险', '环境风险', '质量风险', '安全风险']
    impact_areas = ['进度延迟', '成本增加', '性能降低', '安全隐患', '质量问题']
    
    # 创建风险评分矩阵 (1-10分)
    risk_matrix = np.array([
        [8, 7, 9, 5, 8],  # 技术风险对各影响区域的分值
        [9, 6, 5, 3, 6],  # 进度风险对各影响区域的分值
        [7, 5, 7, 6, 8],  # 人员风险对各影响区域的分值
        [6, 4, 8, 7, 7],  # 环境风险对各影响区域的分值
        [5, 7, 9, 4, 9],  # 质量风险对各影响区域的分值
        [4, 8, 6, 9, 7]   # 安全风险对各影响区域的分值
    ])
    
    # 创建图表
    fig, ax = plt.subplots(figsize=(12, 8))
    
    # 创建热图
    im = ax.imshow(risk_matrix, cmap='YlOrRd')
    
    # 添加刻度和标签
    ax.set_xticks(np.arange(len(impact_areas)))
    ax.set_yticks(np.arange(len(risk_categories)))
    ax.set_xticklabels(impact_areas)
    ax.set_yticklabels(risk_categories)
    
    # 旋转X轴标签以避免重叠
    plt.setp(ax.get_xticklabels(), rotation=45, ha="right", rotation_mode="anchor")
    
    # 添加风险评分数值
    for i in range(len(risk_categories)):
        for j in range(len(impact_areas)):
            text = ax.text(j, i, risk_matrix[i, j],
                          ha="center", va="center", color="black" if risk_matrix[i, j] < 7 else "white")
    
    # 添加颜色条
    cbar = ax.figure.colorbar(im, ax=ax)
    cbar.ax.set_ylabel("风险评分", rotation=-90, va="bottom")
    
    # 设置标题
    ax.set_title("部署风险评估热图", fontsize=14)
    
    # 调整布局
    fig.tight_layout()
    
    return fig

# 资源分配可视化
def create_resource_allocation():
    # 部署阶段
    phases = ['前期准备', '硬件部署', '软件部署', '系统调试', '验收测试', '培训交付']
    
    # 各阶段的资源分配
    personnel = [3, 5, 4, 6, 4, 3]  # 人员数量
    equipment = [1, 5, 3, 4, 2, 1]  # 设备资源
    budget_percent = [10, 30, 20, 25, 10, 5]  # 预算百分比
    
    # 创建图表
    fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))
    
    # 人员和设备资源分配条形图
    x = np.arange(len(phases))
    width = 0.35
    
    rects1 = ax1.bar(x - width/2, personnel, width, label='人员资源', color='royalblue')
    rects2 = ax1.bar(x + width/2, equipment, width, label='设备资源', color='seagreen')
    
    ax1.set_ylabel('资源数量')
    ax1.set_title('部署各阶段资源分配')
    ax1.set_xticks(x)
    ax1.set_xticklabels(phases)
    ax1.legend()
    
    # 为条形图添加标签
    for rect in rects1:
        height = rect.get_height()
        ax1.annotate(f'{height}',
                    xy=(rect.get_x() + rect.get_width() / 2, height),
                    xytext=(0, 3),
                    textcoords="offset points",
                    ha='center', va='bottom')
    
    for rect in rects2:
        height = rect.get_height()
        ax1.annotate(f'{height}',
                    xy=(rect.get_x() + rect.get_width() / 2, height),
                    xytext=(0, 3),
                    textcoords="offset points",
                    ha='center', va='bottom')
    
    # 预算分配饼图
    ax2.pie(budget_percent, labels=phases, autopct='%1.1f%%', startangle=90,
           colors=plt.cm.tab10.colors, shadow=True)
    ax2.axis('equal')
    ax2.set_title('预算分配比例')
    
    plt.tight_layout()
    return fig

# 示例数据
today = datetime.now()
tasks = [
    "需求确认与准备",
    "场地准备与环境评估",
    "硬件设备准备",
    "机械安装",
    "电气安装",
    "光学系统安装",
    "系统集成调试",
    "软件部署配置",
    "参数优化",
    "验收测试准备",
    "功能测试",
    "性能测试",
    "验收测试",
    "用户培训",
    "文档交付"
]

start_dates = [
    today,
    today + timedelta(days=7),
    today + timedelta(days=7),
    today + timedelta(days=14),
    today + timedelta(days=14),
    today + timedelta(days=18),
    today + timedelta(days=21),
    today + timedelta(days=21),
    today + timedelta(days=28),
    today + timedelta(days=35),
    today + timedelta(days=42),
    today + timedelta(days=49),
    today + timedelta(days=56),
    today + timedelta(days=63),
    today + timedelta(days=63)
]

durations = [7, 7, 7, 7, 4, 3, 7, 14, 7, 7, 7, 7, 7, 3, 3]

# 任务依赖关系
dependencies = [
    (0, 1), (0, 2),  # 需求确认是场地准备和硬件准备的前置
    (1, 3), (1, 4),  # 场地准备是机械和电气安装的前置
    (2, 3), (2, 4), (2, 5),  # 硬件准备是各安装的前置
    (3, 6), (4, 6), (5, 6),  # 各安装是集成调试的前置
    (6, 8), (7, 8),  # 集成调试和软件部署是参数优化的前置
    (8, 9),  # 参数优化是验收测试准备的前置
    (9, 10), (9, 11),  # 测试准备是功能和性能测试的前置
    (10, 12), (11, 12),  # 功能和性能测试是验收的前置
    (12, 13), (12, 14)  # 验收是培训和文档的前置
]

# 资源分配
resources = [
    "项目经理,系统工程师",
    "设施团队",
    "采购团队",
    "机械工程师",
    "电气工程师",
    "光学工程师",
    "集成团队",
    "软件工程师",
    "工程师团队",
    "测试团队",
    "测试团队",
    "测试团队",
    "验收团队,客户",
    "培训师",
    "文档团队"
]

# 创建甘特图
gantt_fig = create_gantt_chart(tasks, start_dates, durations, dependencies, resources)
plt.figure(gantt_fig.number)
plt.show()

# 创建风险热图
risk_fig = create_risk_heatmap()
plt.figure(risk_fig.number)
plt.show()

# 创建资源分配图
resource_fig = create_resource_allocation()
plt.figure(resource_fig.number)
plt.show()
```
- 记录：
    - 部署规划关键要点：

## 环境配置与要求
- 场地规划与要求
- 电力需求与配置
- 网络环境规划
- 温湿度控制
- 防尘防震措施
- 记录：
    - 环境条件对系统影响：

## 硬件安装与调试
- 机械装配流程
- 电气安装规范
- 相机光源安装
- 精密调整与校准
- 硬件测试与验收
- 记录：
    - 硬件安装经验总结：

## 软件部署与配置
- 操作系统配置
- 应用软件部署
- 数据库配置
- 权限与安全设置
- 网络设置与通信
- 记录：
    - 软件部署要点：

## 系统参数优化
- 相机参数优化
- 算法参数调优
- 处理性能优化
- 内存与存储优化
- 调优工具与方法
- 记录：
    - 参数优化实践经验：

## 验收测试流程
- 验收测试计划
- 功能测试方法
- 性能测试方案
- 稳定性测试
- 验收标准与文档
- 记录：
    - 测试重点与经验：

## 运行监控系统
- 监控指标设计
- 实时监控架构
- 数据采集与可视化
- 告警系统配置
- 历史数据分析
- 记录：
    - 监控系统实施经验：

## 故障诊断与处理
- 常见故障分析
- 诊断流程与方法
- 紧急处理预案
- 故障分类与处理
- 故障报告与分析
- 记录：
    - 典型故障处理案例：

## 预防性维护
- 维护策略与计划
- 定期检查项目
- 系统性能监测
- 设备寿命管理
- 维护记录与分析
- 记录：
    - 预防性维护实施经验：

## 系统升级与扩展
- 升级需求分析
- 升级路径规划
- 兼容性评估
- 版本控制策略
- 扩展设计考量
- 记录：
    - 系统升级案例分析：

## 学习资源与书签
- 部署与运维标准
- 工具与软件资源
- 案例与最佳实践
- 培训与认证
- 记录：
    - 资源链接：

## 学习进度与 TODO 列表
- [ ] 部署规划方法学习
- [ ] 环境配置要求掌握
- [ ] 硬件安装流程实践
- [ ] 系统参数优化方法
- [ ] 故障诊断与处理技能
- 自定义进度记录区：

---

备注：每个章节下可按"要点 / 操作指南 / 习题 / 参考链接 / 个人笔记"五小节结构补充内容。